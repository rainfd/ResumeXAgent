# Story 4.2: 开发项目经历充实度平衡检测

## Status

Draft

## Story

**As a** 用户，
**I want** AI 评估我的项目描述是否适度充实，
**so that** 在真实性和吸引力之间找到最佳平衡

## Acceptance Criteria

1. AI 识别过于简单需要充实的描述
2. 识别可能引起质疑的过度夸大描述
3. 为"太实在"的描述提供合理的提升建议
4. 为"水分过高"的描述提供更可信的表述
5. 提供具体的修改建议而非抽象评价
6. 保持建议的实用性和可操作性

## Tasks / Subtasks

- [ ] Task 1: 创建项目描述充实度分析服务 (AC: 1, 2)
  - [ ] 创建 `lib/services/content-balance-analyzer.service.ts` 充实度分析服务
  - [ ] 实现AI模型调用（DeepSeek/OpenRouter）
  - [ ] 开发充实度评估算法
  - [ ] 集成项目内容长度和复杂度分析
  - [ ] 添加夸大程度检测机制
- [ ] Task 2: 实现简化描述识别 (AC: 1, 3)
  - [ ] 创建 `lib/analyzers/simplicity-detector.analyzer.ts` 简化检测器
  - [ ] 实现内容深度评估算法
  - [ ] 开发关键信息缺失检测
  - [ ] 添加技术细节不足识别
  - [ ] 实现价值体现不够检测
- [ ] Task 3: 开发过度夸大检测 (AC: 2, 4)
  - [ ] 创建 `lib/analyzers/exaggeration-detector.analyzer.ts` 夸大检测器
  - [ ] 实现不可信声明识别
  - [ ] 开发过度修饰词汇检测
  - [ ] 添加不合理成果声明识别
  - [ ] 实现可信度评估算法
- [ ] Task 4: 构建平衡建议生成器 (AC: 3, 4, 5)
  - [ ] 创建 `lib/generators/balance-suggestion.generator.ts` 平衡建议生成器
  - [ ] 实现针对简化描述的提升建议
  - [ ] 开发针对夸大描述的修正建议
  - [ ] 添加具体可行的改进方案
  - [ ] 实现建议的可操作性验证
- [ ] Task 5: 开发充实度评分系统 (AC: 1, 2, 6)
  - [ ] 创建 `lib/scorers/content-balance.scorer.ts` 充实度评分器
  - [ ] 实现多维度平衡评分算法
  - [ ] 开发可信度与吸引力平衡指标
  - [ ] 添加行业标准对比功能
  - [ ] 实现评分可视化支持
- [ ] Task 6: 创建充实度分析UI组件 (AC: 1-6)
  - [ ] 创建 `components/analysis/content-balance-checker.tsx` 充实度检测组件
  - [ ] 实现项目描述平衡度可视化
  - [ ] 开发问题标注和高亮功能
  - [ ] 添加改进建议展示界面
  - [ ] 实现平衡度评分展示
- [ ] Task 7: 集成充实度分析API (AC: 1-6)
  - [ ] 创建 `app/api/analysis/content-balance/route.ts` 充实度分析API
  - [ ] 实现项目经历数据获取
  - [ ] 集成充实度分析服务
  - [ ] 添加分析结果存储
  - [ ] 实现历史记录和对比功能

## Dev Notes

### Previous Story Insights [Source: Story 4.1 Dev Notes]

- **STAR分析基础**: 已建立项目经历分析框架，可复用于充实度检测
- **AI集成成熟**: OpenRouter/DeepSeek API集成模式已确立，具备完整错误处理
- **项目经历结构**: 已有标准化的项目经历数据模型和提取机制
- **分析UI模式**: STAR检测UI组件设计可作为充实度分析界面参考

### 技术栈要求 [Source: architecture/技术栈.md]

- **AI服务**: DeepSeek API（中文充实度评估）+ OpenRouter API（多模型对比）
- **数据库**: SQLite（充实度分析结果存储）
- **类型系统**: TypeScript 5.3.3（严格类型检查）
- **UI框架**: React 18.3.0 + shadcn/ui（平衡度可视化展示）

### 充实度分析架构设计

**充实度分析服务接口:**

```typescript
interface ContentBalanceAnalyzer {
  analyzeBalance(projectText: string): Promise<BalanceAnalysisResult>;
  detectSimplicity(content: string): Promise<SimplicityIssue[]>;
  detectExaggeration(content: string): Promise<ExaggerationIssue[]>;
  generateBalanceSuggestions(analysis: BalanceAnalysisResult): Promise<BalanceSuggestion[]>;
}

interface BalanceAnalysisResult {
  projectId: string;
  overallScore: BalanceScore;
  simplicityIssues: SimplicityIssue[];
  exaggerationIssues: ExaggerationIssue[];
  recommendations: BalanceSuggestion[];
  improvementPotential: number;
}

interface BalanceScore {
  contentDepth: number; // 内容深度 (0-100)
  credibility: number; // 可信度 (0-100)
  attractiveness: number; // 吸引力 (0-100)
  overallBalance: number; // 整体平衡度 (0-100)
}

interface SimplicityIssue {
  type: 'lack_detail' | 'missing_impact' | 'vague_description' | 'no_quantification';
  text: string;
  position: TextPosition;
  severity: 'high' | 'medium' | 'low';
  suggestion: string;
}

interface ExaggerationIssue {
  type: 'unrealistic_claim' | 'excessive_modifier' | 'vague_superlative' | 'unverifiable_result';
  text: string;
  position: TextPosition;
  severity: 'high' | 'medium' | 'low';
  alternativePhrasing: string;
}
```

### 充实度检测规则体系

**简化描述检测规则:**

1. **缺乏细节**: 
   - 检测关键词：负责、参与、完成、实现（无具体描述）
   - 缺失指标：具体技术栈、实现方法、解决方案
   - 建议方向：添加技术细节、方法论、具体步骤

2. **价值体现不足**:
   - 检测模式：只描述做了什么，不描述产生的价值
   - 缺失要素：业务影响、效率提升、问题解决
   - 建议方向：量化成果、业务价值、团队贡献

3. **描述过于模糊**:
   - 检测词汇：一些、很多、比较好、还不错
   - 问题表现：时间模糊、范围不明、成果不清
   - 建议方向：具体数据、明确范围、量化指标

**过度夸大检测规则:**

1. **不现实的声明**:
   - 检测模式：单人完成复杂项目、短时间巨大成果
   - 风险词汇：独立完成、全面负责、完全重构
   - 建议方向：团队协作、阶段性成果、合理范围

2. **过度修饰**:
   - 检测词汇：革命性、颠覆性、史上最、业界首创
   - 问题表现：形容词过多、绝对化表述
   - 建议方向：客观描述、具体成果、行业对比

3. **无法验证的结果**:
   - 检测模式：巨幅提升但无具体数据支撑
   - 问题表现：虚假量化、夸大比例、不合理指标
   - 建议方向：合理估算、可验证指标、保守表述

### 数据模型扩展 [Source: architecture/数据模型.md#Analysis]

**新增充实度分析结果存储:**

```typescript
interface ContentBalanceAnalysis extends BaseAnalysis {
  analysis_type: 'content_balance';
  results: BalanceAnalysisResult;
  simplicity_score: number;
  exaggeration_score: number;
  balance_recommendations: BalanceSuggestion[];
  improvement_plan: ImprovementStep[];
}

interface BalanceSuggestion {
  type: 'enhance_detail' | 'reduce_exaggeration' | 'add_quantification' | 'improve_credibility';
  priority: 'high' | 'medium' | 'low';
  original_text: string;
  suggested_improvement: string;
  explanation: string;
  impact_level: number;
}

interface ImprovementStep {
  step_order: number;
  action: string;
  expected_outcome: string;
  difficulty: 'easy' | 'medium' | 'hard';
}
```

### AI提示词策略

**充实度评估提示词模版:**

```
分析以下项目经历描述的充实度平衡情况：

项目描述：[PROJECT_TEXT]

请从以下维度进行评估：

1. 内容深度分析：
   - 技术细节是否充分
   - 解决方案是否具体
   - 实施过程是否清晰

2. 可信度评估：
   - 声明是否现实可信
   - 成果是否合理验证
   - 时间和规模是否匹配

3. 识别问题类型：
   - 过于简单需要充实的部分
   - 可能过度夸大的表述
   - 缺乏支撑的声明

4. 改进建议：
   - 具体可行的修改方案
   - 保持真实性的前提下增强吸引力
   - 提供可替代的表述方式

请以JSON格式返回分析结果。
```

### 项目结构要求 [Source: architecture/源代码树.md]

**充实度分析相关文件:**

```
lib/services/
├── content-balance-analyzer.service.ts  # 主要充实度分析服务
└── balance-optimization.service.ts      # 平衡优化服务

lib/analyzers/
├── simplicity-detector.analyzer.ts      # 简化检测器
├── exaggeration-detector.analyzer.ts    # 夸大检测器
└── credibility-scorer.analyzer.ts       # 可信度评分器

lib/generators/
├── balance-suggestion.generator.ts      # 平衡建议生成器
└── improvement-plan.generator.ts        # 改进计划生成器

lib/scorers/
├── content-balance.scorer.ts            # 充实度评分器
└── balance-metrics.scorer.ts            # 平衡度指标计算器

lib/types/
├── content-balance.types.ts             # 充实度分析类型定义
└── balance-suggestion.types.ts          # 平衡建议类型定义

components/analysis/
├── content-balance-checker.tsx          # 充实度检测主组件
├── balance-score-display.tsx            # 平衡度评分展示
├── simplicity-issues.tsx                # 简化问题展示
├── exaggeration-warnings.tsx            # 夸大警告展示
└── balance-suggestions.tsx              # 平衡建议组件

app/api/analysis/
└── content-balance/route.ts             # 充实度分析API接口
```

### 性能和用户体验要求

**分析性能:**
- 单个项目分析时间 < 12秒
- 支持批量分析（最多10个项目）
- 实时评分计算和可视化
- AI调用结果缓存优化

**用户体验:**
- 问题标注清晰可见
- 建议按优先级排序展示
- 改进前后对比预览
- 平衡度评分动态展示

### AI成本控制策略

**智能分析策略:**
1. **预处理过滤**: 先用规则引擎筛选明显问题
2. **分层分析**: 根据内容复杂度选择AI模型
3. **缓存优化**: 相似内容复用分析结果
4. **批量处理**: 减少API调用频次

### Testing Requirements [Source: architecture/测试策略和标准.md]

**测试数据准备:**
- 过于简单的项目描述样本
- 过度夸大的项目描述样本
- 平衡良好的标准项目描述
- 边界情况和异常输入

**测试指标:**
- 简化检测准确率（>80%）
- 夸大检测准确率（>85%）
- 建议相关性评估（>90%）
- 用户满意度评估（>85%）

### 安全和隐私考虑

**数据安全:**
- 项目内容敏感信息过滤
- AI分析结果定期清理
- 用户隐私保护机制
- 分析日志安全存储

## Change Log

| Date       | Version | Description                        | Author       |
| ---------- | ------- | ---------------------------------- | ------------ |
| 2025-08-09 | 1.0     | 初始故事创建，基于Epic 4.2要求     | Scrum Master |

## Dev Agent Record

### Agent Model Used

待实现

### Debug Log References

待实现

### Completion Notes List

待实现

### File List

待实现

## QA Results

### Review Date

待审查

### Reviewed By

待指定