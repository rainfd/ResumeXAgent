# Story 4.3: 实现 AI 驱动的项目经历优化

## Status

Draft

## Story

**As a** 用户，
**I want** AI 帮我重写项目经历，
**so that** 提升描述的专业性和吸引力

## Acceptance Criteria

1. 基于原始描述，AI 生成优化版本
2. 保持真实性的同时增强表现力
3. 自动添加合适的量化指标建议
4. 突出个人贡献和技术亮点
5. 提供多个改写版本供用户选择
6. 支持用户微调 AI 生成的内容

## Tasks / Subtasks

- [ ] Task 1: 创建项目经历优化服务 (AC: 1, 2)
  - [ ] 创建 `lib/services/project-optimizer.service.ts` 项目优化服务
  - [ ] 实现AI模型调用（DeepSeek/OpenRouter）
  - [ ] 开发原始内容分析算法
  - [ ] 集成真实性保持机制
  - [ ] 添加优化质量评估功能
- [ ] Task 2: 实现量化指标智能建议 (AC: 3)
  - [ ] 创建 `lib/generators/metrics-suggestion.generator.ts` 量化建议生成器
  - [ ] 实现业务影响量化算法
  - [ ] 开发技术性能指标建议
  - [ ] 添加时间效率量化建议
  - [ ] 实现成本效益量化建议
- [ ] Task 3: 开发个人贡献突出功能 (AC: 4)
  - [ ] 创建 `lib/analyzers/contribution-highlighter.analyzer.ts` 贡献突出分析器
  - [ ] 实现个人角色识别算法
  - [ ] 开发技术亮点提取功能
  - [ ] 添加领导能力体现机制
  - [ ] 实现创新点识别和强化
- [ ] Task 4: 构建多版本改写生成器 (AC: 5)
  - [ ] 创建 `lib/generators/multi-version-rewriter.generator.ts` 多版本改写器
  - [ ] 实现不同风格的改写模式（技术型、管理型、创新型）
  - [ ] 开发改写难度分级（保守、适中、激进）
  - [ ] 添加行业特定优化模板
  - [ ] 实现版本质量评分和排序
- [ ] Task 5: 开发用户微调编辑功能 (AC: 6)
  - [ ] 创建 `lib/services/content-editor.service.ts` 内容编辑服务
  - [ ] 实现智能建议应用机制
  - [ ] 开发部分内容替换功能
  - [ ] 添加用户偏好学习功能
  - [ ] 实现编辑历史和回滚机制
- [ ] Task 6: 创建项目优化UI组件 (AC: 1-6)
  - [ ] 创建 `components/optimization/project-optimizer.tsx` 项目优化主组件
  - [ ] 实现原文与优化版本对比展示
  - [ ] 开发多版本选择和预览界面
  - [ ] 添加量化建议交互式应用
  - [ ] 实现用户微调编辑界面
- [ ] Task 7: 集成项目优化API (AC: 1-6)
  - [ ] 创建 `app/api/optimization/project/route.ts` 项目优化API
  - [ ] 实现项目经历数据获取
  - [ ] 集成多AI模型优化服务
  - [ ] 添加优化结果存储和版本管理
  - [ ] 实现优化历史和A/B测试支持

## Dev Notes

### Previous Story Insights [Source: Story 4.1-4.2 Dev Notes]

- **STAR分析和充实度检测基础**: 已建立完整的项目经历分析框架，可作为优化输入
- **AI集成成熟**: OpenRouter/DeepSeek API集成模式已确立，具备完整错误处理和重试机制
- **多维度分析能力**: STAR要素检测和充实度平衡分析为优化提供了详细的改进方向
- **UI组件复用**: 已有分析结果展示和对比界面可复用于优化版本展示

### 技术栈要求 [Source: architecture/技术栈.md]

- **AI服务**: OpenRouter API（多模型优化对比）+ DeepSeek API（中文内容优化）
- **数据库**: SQLite（优化版本和用户偏好存储）
- **类型系统**: TypeScript 5.3.3（严格类型检查）
- **UI框架**: React 18.3.0 + shadcn/ui（优化界面和版本对比）

### 项目优化架构设计

**项目优化服务接口:**

```typescript
interface ProjectOptimizerService {
  optimizeProject(originalText: string, options: OptimizationOptions): Promise<OptimizationResult>;
  generateMultipleVersions(text: string, count: number): Promise<OptimizedVersion[]>;
  suggestQuantificationMetrics(content: string): Promise<MetricSuggestion[]>;
  highlightContributions(text: string): Promise<ContributionHighlight[]>;
  applyUserEdits(version: OptimizedVersion, edits: UserEdit[]): Promise<OptimizedVersion>;
}

interface OptimizationOptions {
  style: 'technical' | 'managerial' | 'innovative' | 'balanced';
  level: 'conservative' | 'moderate' | 'aggressive';
  targetRole?: string;
  industryContext?: string;
  preserveSpecifics: boolean;
}

interface OptimizationResult {
  originalText: string;
  optimizedVersions: OptimizedVersion[];
  appliedImprovements: ImprovementApplied[];
  qualityScore: QualityMetrics;
  suggestions: OptimizationSuggestion[];
}

interface OptimizedVersion {
  id: string;
  version_number: number;
  optimized_text: string;
  optimization_style: string;
  improvements_made: string[];
  quality_score: number;
  user_rating?: number;
  edit_history: UserEdit[];
}

interface MetricSuggestion {
  category: 'performance' | 'efficiency' | 'scale' | 'impact' | 'cost_saving';
  suggested_metric: string;
  example_values: string[];
  justification: string;
  confidence: number;
}

interface ContributionHighlight {
  type: 'technical_leadership' | 'innovation' | 'problem_solving' | 'team_collaboration';
  original_phrase: string;
  highlighted_version: string;
  impact_description: string;
}
```

### 项目优化策略体系

**优化维度框架:**

1. **专业性提升**:
   - 技术术语准确使用
   - 行业标准规范表述
   - 方法论和框架体现
   - 最佳实践应用展示

2. **吸引力增强**:
   - 动作词汇优化（实现→设计并实现）
   - 成果导向表述（做了什么→产生什么价值）
   - 挑战和解决方案突出
   - 创新和亮点强化

3. **量化指标智能建议**:
   - 性能改进指标（响应时间、吞吐量）
   - 业务影响数据（用户增长、收入提升）
   - 效率提升量化（开发时间、维护成本）
   - 规模和范围数据（团队规模、项目周期）

4. **个人贡献突出**:
   - 领导角色体现（带领、指导、协调）
   - 技术决策权重（选型、架构、方案设计）
   - 问题解决能力（诊断、分析、解决）
   - 创新贡献识别（首次尝试、优化改进）

### AI优化提示词策略

**项目经历优化提示词模板:**

```
请优化以下项目经历描述，要求：

原始描述：[ORIGINAL_TEXT]
优化风格：[STYLE] (技术型/管理型/创新型/平衡型)
优化程度：[LEVEL] (保守/适中/激进)
目标岗位：[TARGET_ROLE]

优化要求：
1. 保持事实真实性，不虚构不存在的成果
2. 增强专业性表达，使用准确的技术和行业术语
3. 突出个人贡献和技术亮点
4. 建议具体可量化的指标
5. 优化语言表达的吸引力和说服力
6. 符合目标岗位的能力要求

请提供3个不同版本的优化结果：
- 版本1：保守优化（保持原有结构，主要改进措辞）
- 版本2：适度优化（重组结构，增强亮点）
- 版本3：积极优化（全面重写，最大化吸引力）

每个版本请说明：
- 主要改进点
- 添加的量化建议
- 突出的个人贡献
- 风险评估

以JSON格式返回结果。
```

### 数据模型扩展 [Source: architecture/数据模型.md#Analysis]

**新增项目优化结果存储:**

```typescript
interface ProjectOptimization extends BaseAnalysis {
  analysis_type: 'project_optimization';
  original_text: string;
  optimization_options: OptimizationOptions;
  generated_versions: OptimizedVersion[];
  selected_version_id?: string;
  user_satisfaction_rating?: number;
  final_edited_content?: string;
}

interface ImprovementApplied {
  type: 'quantification' | 'contribution_highlight' | 'technical_enhancement' | 'language_optimization';
  description: string;
  before: string;
  after: string;
  impact_score: number;
}

interface UserEdit {
  timestamp: Date;
  edit_type: 'replace' | 'insert' | 'delete' | 'reorder';
  original_text: string;
  new_text: string;
  position: TextPosition;
  reason?: string;
}

interface QualityMetrics {
  technical_accuracy: number;
  professional_tone: number;
  impact_clarity: number;
  quantification_level: number;
  overall_improvement: number;
}
```

### 优化版本生成策略

**多版本生成逻辑:**

1. **保守版本** (Conservative):
   - 保持原有结构不变
   - 主要优化词汇选择和语法
   - 适度添加量化指标
   - 风险最低，适合求稳用户

2. **适中版本** (Moderate):
   - 重新组织段落结构
   - 增强技术亮点表述
   - 合理添加个人贡献
   - 平衡真实性和吸引力

3. **积极版本** (Aggressive):
   - 全面重写项目描述
   - 最大化技术和业务价值
   - 突出领导力和创新点
   - 高吸引力但需谨慎使用

### 项目结构要求 [Source: architecture/源代码树.md]

**项目优化相关文件:**

```
lib/services/
├── project-optimizer.service.ts       # 主要项目优化服务
└── content-editor.service.ts          # 内容编辑服务

lib/generators/
├── metrics-suggestion.generator.ts    # 量化建议生成器
└── multi-version-rewriter.generator.ts # 多版本改写器

lib/analyzers/
├── contribution-highlighter.analyzer.ts # 贡献突出分析器
├── technical-enhancer.analyzer.ts      # 技术增强分析器
└── optimization-evaluator.analyzer.ts  # 优化质量评估器

lib/types/
├── project-optimization.types.ts       # 项目优化类型定义
├── optimization-result.types.ts        # 优化结果类型定义
└── user-edit.types.ts                 # 用户编辑类型定义

components/optimization/
├── project-optimizer.tsx              # 项目优化主组件
├── version-comparison.tsx              # 版本对比组件
├── metrics-suggestion-panel.tsx       # 量化建议面板
├── contribution-highlighter.tsx       # 贡献突出展示
├── edit-interface.tsx                 # 编辑界面组件
└── optimization-history.tsx           # 优化历史组件

app/api/optimization/
└── project/route.ts                   # 项目优化API接口
```

### 性能和用户体验要求

**优化性能:**
- 单个项目优化时间 < 20秒
- 多版本并行生成支持
- AI响应流式处理展示
- 优化结果缓存机制

**用户体验:**
- 实时优化进度显示
- 版本对比可视化清晰
- 编辑操作实时预览
- 优化质量评分直观展示

### AI成本控制策略

**智能优化策略:**
1. **分层优化**: 根据内容长度和复杂度选择AI模型
2. **模板复用**: 相似项目经历复用优化模板
3. **用户选择**: 提供不同质量级别的优化选项
4. **缓存机制**: 缓存常见优化模式和结果

### Testing Requirements [Source: architecture/测试策略和标准.md]

**测试数据准备:**
- 不同行业和岗位的项目经历样本
- 不同质量水平的原始描述（简单、中等、复杂）
- 用户编辑操作测试场景
- 多版本生成一致性测试

**测试指标:**
- 优化质量提升度量（>30%改进）
- 用户满意度评估（>85%）
- 真实性保持度（人工评估>95%）
- 版本生成稳定性（>98%成功率）

### 安全和隐私考虑

**内容安全:**
- 敏感信息识别和保护
- 优化版本风险评估
- 用户编辑记录隐私保护
- AI生成内容合规检查

### 用户偏好学习机制

**个性化优化:**
- 用户选择模式记录
- 编辑习惯分析
- 行业偏好识别
- 个性化推荐算法

## Change Log

| Date       | Version | Description                        | Author       |
| ---------- | ------- | ---------------------------------- | ------------ |
| 2025-08-09 | 1.0     | 初始故事创建，基于Epic 4.3要求     | Scrum Master |

## Dev Agent Record

### Agent Model Used

待实现

### Debug Log References

待实现

### Completion Notes List

待实现

### File List

待实现

## QA Results

### Review Date

待审查

### Reviewed By

待指定